2021年度 サブゼミ 第11回 データハンドリング2
================
Yoshinari Namba
2021/6/24

|                                   |
|-----------------------------------|
| データハンドリングの第2回目です． |

# 0. Setup & Agenda

## 準備1: データ

今日は以下のデータを使用します．コピペして実行しておいてください．

``` r
# 今日使うデータの作成
df_score <- data.frame(name = c('生徒C', '生徒A', '生徒B', '生徒A'), 
                 class_size = c('small', 'large', 'small', 'large'), 
                 math_score = c(80, 70, 75, 70), 
                 eng_score = c(70, 75, 80, 75))
# 確認
df_score
```

    ##    name class_size math_score eng_score
    ## 1 生徒C      small         80        70
    ## 2 生徒A      large         70        75
    ## 3 生徒B      small         75        80
    ## 4 生徒A      large         70        75

## 準備2: パッケージ

今日も`tidyverse`を使用します．インストールが済んでいない人は先ず`install.packages('tidyverse')`を実行してくださいね．

``` r
# tidyverseの呼び出し
library(tidyverse)
```

    ## Warning: package 'tidyverse' was built under R version 4.0.3

    ## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --

    ## v ggplot2 3.3.1     v purrr   0.3.4
    ## v tibble  3.0.1     v dplyr   1.0.2
    ## v tidyr   1.1.0     v stringr 1.4.0
    ## v readr   1.3.1     v forcats 0.5.0

    ## Warning: package 'tidyr' was built under R version 4.0.2

    ## Warning: package 'dplyr' was built under R version 4.0.3

    ## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

## Agenda

今日のAgendaは次の通りです． 1. データ整理(続き) 2. 文字列の操作 3.
グループワーク

# 1. データ整理

前回は主に`dplyr`を使った行列の扱い方や集計方法を学びました．今回は前回の続きです．  
まずは復習として前回のグループワークの答えを確認したいと思います．

``` r
# データの取り込み
df_review <- read.csv('wage1_editted.csv')
head(df_review) # 確認
```

    ##    wage educ exper female married industry
    ## 1  3.24   12    22      1       1 services
    ## 2  3.00   11     2      0       0    trade
    ## 3  8.75   16     9      0       1 profserv
    ## 4 11.25   18    15      0       0    trade
    ## 5  3.60   12    26      1       0    trade
    ## 6  6.25   16     8      1       0    trade

``` r
# 教育過剰・教育過少を作成
df_review_ans <- df_review %>% 
  group_by(industry) %>% # 商業区分industry でグループ化
  mutate(ad_educ = mean(educ)) %>% # 適正教育年数 ad_educを定義
  ungroup() %>% #グループ解除
  mutate(ov_educ = ifelse(educ - ad_educ > 0, educ - ad_educ, 0), # 教育過剰年数 ov_educを定義
         un_educ = ifelse(educ - ad_educ < 0, ad_educ - educ, 0)) # 教育過少年数 un_educを定義
head(df_review_ans) #確認
```

    ## # A tibble: 6 x 9
    ##    wage  educ exper female married industry ad_educ ov_educ un_educ
    ##   <dbl> <int> <int>  <int>   <int> <chr>      <dbl>   <dbl>   <dbl>
    ## 1  3.24    12    22      1       1 services    12.0  0.0377   0    
    ## 2  3       11     2      0       0 trade       12.3  0        1.30 
    ## 3  8.75    16     9      0       1 profserv    13.6  2.43     0    
    ## 4 11.2     18    15      0       0 trade       12.3  5.70     0    
    ## 5  3.60    12    26      1       0 trade       12.3  0        0.305
    ## 6  6.25    16     8      1       0 trade       12.3  3.70     0
